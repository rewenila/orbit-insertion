function CD = modelo_aerodinamico(V,h,M,Kn,T)
% Modelo de arrasto conforme a referência:
% TEWARI, A. Atmospheric and Space Flight Dynamics: Modelling and
% simulation with MATLAB and Simulink. Borston: Birkhauser, 2007.
% Exemplo 12.6
% Entradas
% V: velocidade [m/s]
% M: número de Mach
% Kn: número de Knudsen
% T: temperatura [K]
% Saída
% CD: coeficiente de arrasto
R = 287;
s = V/sqrt(2*R*T);
CDfm = 1.75 + sqrt(pi)/(2*s);
CDc = iterpCD(M);
if h < 2000e3
    if Kn < 0.0146
        CD = CDc;
    elseif Kn < 14.5
        CD = CDc + (CDfm - CDc)*((1/3)*log10(Kn/sin(30*pi/180)) + 0.05113);
    else
        CD = CDfm;
    end
else
    CD = 0;
end
end

function CDc = iterpCD(M)
% Função para calcular o coeficiente de arrasto contínuo
% Dados extraídos de TEWARI, 2007
CD = [4.440892098500626e-16 0.473611111111111
      0.16091954022988508   0.473611111111111
      0.3448275862068968    0.47638888888888886
      0.48275862068965525   0.48749999999999993
      0.5260937284359541    0.5001384509281878
      0.6423506371456926    0.5140964621507074
      0.7090554208316084    0.5388896829934564
      0.7521052308070568    0.5646438821383326
      0.8462766901283496    0.5904747157105646
      0.8735632183908049    0.6152777777777777
      0.9064614573637622    0.6666828054985948
      0.9377575363261772    0.6374539419350739
      0.9491926421009054    0.7028563941299789
      0.9530043440258145    0.7217402007496345
      0.9720628536503622    0.7857609109967598
      0.9758745555752717    0.8046447176164155
      0.994933065199819     0.8679745568896511
      0.9987447671247285    0.8866280731846767
      1.0049387827527076    1.0312668463611858
      1.0114942528735638    0.9833333333333332
      1.0178032767492757    0.9501882027825422
      1.0246643402141133    1.0132778821458064
      1.03448275862069      0.9666666666666665
      1.126436781609196     1.0124999999999997
      1.1494252873563222    0.9958333333333331
      1.2183908045977017    0.9833333333333332
      1.2643678160919545    0.9652777777777776
      1.2655639018683917    0.9568666221968107
      1.3036809211174862    0.9398251381741947
      1.3494213442164003    0.9192717267009718
      1.3951617673153138    0.8997546216885838
      1.4409021904142274    0.8797193634457784
      1.486642613513141     0.8596841052029729
      1.5323830366120545    0.8414911695572072
      1.5862068965517246    0.8194444444444443
      1.6696043059087957    0.7924623594434914
      1.738214940557166     0.7705617495711834
      1.8068255752055364    0.7491447493805983
      1.8754362098539072    0.7277277491900132
      1.9770114942528743    0.6944444444444442
      2.184184065771574     0.6596769582618638
      2.275664911969402     0.6444777968362873
      2.355710652392501     0.6314663934946952
      2.607282979436526     0.5941133028397179
      2.7330691429585388    0.5784996188298074
      2.8702904122552795    0.559587025919573
      2.988505747126437     0.5458333333333333
      3.169509013360673     0.5395531384525094
      3.4306105952169723    0.5271867474054437
      3.6821829222609974    0.5170737122924085
      3.971872268554118     0.5108710268301461
      4.185327576349048     0.505958166571374
      4.436899903393073     0.5019385536323785
      4.688472230437098     0.49791894069338316
      4.954488901617623     0.4919904523553975
      5.182087629712874     0.49231346483704963
      5.443189211569174     0.49214074709357714
      5.694761538613199     0.4920779406414053
      5.946333865657224     0.49082181159796934
      6.197906192701249     0.4907590051457975
      6.449478519745274     0.49006813417190764
      6.7010508467892995    0.4893772631980178
      6.952623173833325     0.48925165029367423
      7.20419550087735      0.48805832770241
      7.455767827921375     0.48799552125023815
      7.7073401549654       0.48724184382417646
      7.958912482009425     0.4866137793024584
      8.210484809053451     0.4864881663981149
      8.462057136097474     0.4852948438068506
      8.713629463141501     0.4852320373546788
      8.965201790185525     0.4844783599286171
      9.216774117229551     0.48385029540689906
      9.468346444273578     0.4837246825025555
      9.719918771317602     0.48246855345911943
      10.223063425405625    0.48228013410260395
      10.474635752449679    0.48246855345911943
      10.726208079493702    0.48246855345911943
      10.977780406537729    0.48246855345911943
      11.229352733581752    0.48246855345911943
      11.480925080625779    0.48246855345911943
      11.732497387669802    0.4824057470069476];
  
% Interpolação
CDc = interp1(CD(:,1),CD(:,2),M,'pchip');

end



